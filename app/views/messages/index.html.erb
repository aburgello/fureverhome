<div class="container mt-5 pb-4 rounded mb-3 pet-header">
  <h1 class="text-center my-4">Messages About <%= @adoption.pet.title %></h1>
  <div class="card-msg shadow-sm mb-4 p-3">
    <div class="messages-box mb-4 p-3 border rounded" id="messages-box" style="max-height: 360px; overflow-y: auto; background-color: white">
      <% if @messages.present? %>
        <% @messages.each do |message| %>
          <div class="message mb-3 p-2 border-bottom">
            <div class="message-header d-flex justify-content-between">
              <strong><%= message.user.name %>:</strong>
              <small class="text-muted"><%= message.created_at.strftime("%B %d, %Y %H:%M") %></small>
            </div>
            <p class="mb-0"><%= message.content %></p>
          </div>
        <% end %>
      <% else %>
        <p class="text-center text-muted">Start the conversation!</p>
      <% end %>
    </div>

<% if user_signed_in? && current_user == @adoption.pet.user && @adoption.status != 'accepted' %>
  <div class="d-flex justify-content-end mb-3">
    <%= button_to 'Accept', accept_pet_adoption_path(@adoption.pet, @adoption), method: :patch, class: 'btn btn-success me-2' %>
    <%= link_to 'Reject', pet_adoption_path(@adoption.pet, @adoption), data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
  </div>
<% end %>

    <%= form_with model: [@adoption, @message], local: true, class: 'mb-3' do |f| %>
      <div class="mb-3">
        <%= f.label :content, "New Message", class: 'form-label' %>
        <%= f.text_area :content, class: 'form-control', rows: 3, id: 'message_content' %>
      </div>
      <div class="d-flex justify-content-between">
        <%= f.submit "Send Message", class: 'btn btn-primary btn-lg' %>
        <%= link_to 'Back to Requests', requests_path, class: 'btn btn-secondary btn-lg' %>
      </div>
    <% end %>
  </div>
</div>

<style>
  .btn {
    font-size: 1.1rem;
    background-color: #323440;
  }

  .btn:hover {
    background-color: #fdcd07;
    color: #323440;
  }
</style>